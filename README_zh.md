# TKE Serverless æ€§èƒ½æµ‹è¯• Playbook

[English](README.md) | [ä¸­æ–‡](README_zh.md)

[![License](https://img.shields.io/badge/License-Apache%202.0-blue.svg)](https://opensource.org/licenses/Apache-2.0)
[![TKE](https://img.shields.io/badge/TKE-Serverless-green.svg)](https://cloud.tencent.com/product/tke)
[![Kubernetes](https://img.shields.io/badge/Kubernetes-1.20+-blue.svg)](https://kubernetes.io/)

## ğŸš€ é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®ä¸“é—¨ä¸º**è…¾è®¯äº‘TKE Serverless**ï¼ˆå¼¹æ€§å®¹å™¨æœåŠ¡EKSï¼‰æä¾›å…¨é¢çš„æ€§èƒ½æµ‹è¯•è§£å†³æ–¹æ¡ˆã€‚åŸºäºArgo Workflowæ„å»ºï¼Œæä¾›è‡ªåŠ¨åŒ–çš„æ€§èƒ½æµ‹è¯•æµæ°´çº¿ï¼Œå¸®åŠ©æ‚¨è¯„ä¼°å’Œä¼˜åŒ–Serverlesså®¹å™¨çš„æ€§èƒ½è¡¨ç°ã€‚

### ğŸ¯ æ ¸å¿ƒä»·å€¼

- **æ€§èƒ½åŸºå‡†æµ‹è¯•**ï¼šå»ºç«‹TKE Serverlessçš„æ€§èƒ½åŸºçº¿
- **è‡ªåŠ¨åŒ–æµ‹è¯•**ï¼šä¸€é”®æ‰§è¡Œå®Œæ•´çš„æ€§èƒ½æµ‹è¯•å¥—ä»¶
- **æˆæœ¬ä¼˜åŒ–**ï¼šé€šè¿‡æ€§èƒ½æ•°æ®ä¼˜åŒ–èµ„æºé…ç½®å’Œæˆæœ¬
- **ç”Ÿäº§å°±ç»ª**ï¼šä¸ºç”Ÿäº§ç¯å¢ƒæä¾›æ€§èƒ½ä¿éšœ

### âœ¨ ä¸»è¦ç‰¹æ€§

#### ğŸƒâ€â™‚ï¸ Podå¯åŠ¨æ€§èƒ½æµ‹è¯•
- å¤šè§„æ ¼Podå¯åŠ¨é€Ÿåº¦æµ‹è¯•ï¼ˆ0.25C/0.5Gi ~ 2C/4Giï¼‰
- ä¸åŒé•œåƒå¤§å°å¯¹å¯åŠ¨æ—¶é—´çš„å½±å“åˆ†æ
- æ‰¹é‡Podå¯åŠ¨çš„å¹¶å‘æ€§èƒ½æµ‹è¯•
- å¯åŠ¨æˆåŠŸç‡å’Œç¨³å®šæ€§éªŒè¯

#### ğŸ“ˆ å¼¹æ€§æ‰©ç¼©å®¹æ€§èƒ½æµ‹è¯•
- HPAè‡ªåŠ¨æ‰©å®¹å“åº”æ—¶é—´æµ‹è¯•
- è´Ÿè½½é™ä½åçš„è‡ªåŠ¨ç¼©å®¹æµ‹è¯•
- æ‰©ç¼©å®¹ç¨³å®šæ€§å’ŒæŠ–åŠ¨åˆ†æ
- èµ„æºåˆ©ç”¨ç‡ä¼˜åŒ–å»ºè®®

#### ğŸŒ ç½‘ç»œæ€§èƒ½æµ‹è¯•ï¼ˆè§„åˆ’ä¸­ï¼‰
- Podé—´é€šä¿¡å»¶è¿Ÿæµ‹è¯•
- Serviceè´Ÿè½½å‡è¡¡æ€§èƒ½
- Ingressååé‡æµ‹è¯•
- å¤–ç½‘è®¿é—®æ€§èƒ½è¯„ä¼°

#### ğŸ’¾ å­˜å‚¨æ€§èƒ½æµ‹è¯•ï¼ˆè§„åˆ’ä¸­ï¼‰
- PVCæŒ‚è½½æ€§èƒ½æµ‹è¯•
- ä¸åŒå­˜å‚¨ç±»å‹çš„I/Oæ€§èƒ½
- æ•°æ®æŒä¹…åŒ–éªŒè¯

## ğŸ¯ é€‚ç”¨åœºæ™¯

### ä¸šåŠ¡åœºæ™¯
- **çªå‘æµé‡åº”ç”¨**ï¼šç”µå•†ä¿ƒé”€ã€ç›´æ’­å¸¦è´§ç­‰
- **æ‰¹å¤„ç†ä»»åŠ¡**ï¼šæ•°æ®å¤„ç†ã€æœºå™¨å­¦ä¹ è®­ç»ƒ
- **å¾®æœåŠ¡æ¶æ„**ï¼šäº‘åŸç”Ÿåº”ç”¨éƒ¨ç½²
- **CI/CDæµæ°´çº¿**ï¼šæ„å»ºå’Œéƒ¨ç½²ä»»åŠ¡
- **äº‹ä»¶é©±åŠ¨åº”ç”¨**ï¼šæ¶ˆæ¯å¤„ç†ã€å‡½æ•°è®¡ç®—

### æµ‹è¯•ç›®æ ‡
- éªŒè¯TKE Serverlessåœ¨ä¸åŒè´Ÿè½½ä¸‹çš„æ€§èƒ½è¡¨ç°
- ä¸ºå®¹é‡è§„åˆ’æä¾›æ•°æ®æ”¯æ’‘
- ä¼˜åŒ–èµ„æºé…ç½®ä»¥é™ä½æˆæœ¬
- å»ºç«‹æ€§èƒ½ç›‘æ§å’Œå‘Šè­¦åŸºçº¿

## ğŸ“‹ å‰ç½®æ¡ä»¶

### ç¯å¢ƒè¦æ±‚
- **TKE Serverlessé›†ç¾¤**ï¼šè…¾è®¯äº‘å¼¹æ€§å®¹å™¨æœåŠ¡EKSé›†ç¾¤
- **æºé›†ç¾¤**ï¼šç”¨äºæ‰§è¡Œæµ‹è¯•æµç¨‹çš„Kubernetesé›†ç¾¤ï¼ˆå¯ä»¥æ˜¯æ™®é€šTKEé›†ç¾¤ï¼‰
- **kubectl**ï¼šå·²é…ç½®å¹¶èƒ½è®¿é—®ä¸¤ä¸ªé›†ç¾¤
- **Argo Workflow**ï¼šv3.4.0+

### é›†ç¾¤å‡†å¤‡

#### 1. TKE Serverlessé›†ç¾¤ï¼ˆç›®æ ‡é›†ç¾¤ï¼‰

```bash
# åœ¨TKE Serverlessé›†ç¾¤ä¸­åˆ›å»ºæµ‹è¯•æ ‡è¯†
kubectl create ns tke-serverless-test
kubectl create -n tke-serverless-test configmap tke-serverless-precheck-resource --from-literal=ready="true"

# ç¡®ä¿é›†ç¾¤å·²å¯ç”¨ServerlessèŠ‚ç‚¹æ± 
# åœ¨è…¾è®¯äº‘TKEæ§åˆ¶å°éªŒè¯Serverlessé…ç½®
```

#### 2. æºé›†ç¾¤ï¼ˆæµ‹è¯•æ‰§è¡Œé›†ç¾¤ï¼‰

```bash
# è·å–TKE Serverlessé›†ç¾¤çš„kubeconfig
# ä»è…¾è®¯äº‘TKEæ§åˆ¶å°ä¸‹è½½å†…ç½‘è®¿é—®kubeconfig

# åœ¨æºé›†ç¾¤ä¸­åˆ›å»ºç›®æ ‡é›†ç¾¤è®¿é—®å‡­è¯
kubectl create ns tke-serverless-test
kubectl create -n tke-serverless-test secret generic serverless-cluster-kubeconfig \
  --from-file=config=./serverless-cluster-kubeconfig

# éƒ¨ç½²Argo Workflow
kubectl create -f playbook/install-argo.yaml

# éªŒè¯Argo Workflowè¿è¡ŒçŠ¶æ€
kubectl get po -n tke-serverless-test
```

#### 3. é…ç½®Argo UIè®¿é—®

```bash
# å¼€å¯Argo Server UIå…¬ç½‘è®¿é—®ï¼ˆåœ¨è…¾è®¯äº‘TKEæ§åˆ¶å°ï¼‰
# æˆ–é…ç½®å†…ç½‘è®¿é—®

# è·å–è®¿é—®token
kubectl exec -it -n tke-serverless-test deployment/tke-serverless-argo-workflows-server -- argo auth token
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ä¸€é”®æµ‹è¯•ï¼ˆæ¨èï¼‰

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/wi1123/EKS-playbook.git
cd EKS-playbook

# èµ‹äºˆæ‰§è¡Œæƒé™
chmod +x run-serverless-tests.sh

# æ‰§è¡ŒPodå¯åŠ¨æ€§èƒ½æµ‹è¯•
./run-serverless-tests.sh startup

# æ‰§è¡Œå¼¹æ€§æ‰©ç¼©å®¹æ€§èƒ½æµ‹è¯•
./run-serverless-tests.sh scaling

# æ‰§è¡Œæ‰€æœ‰æ€§èƒ½æµ‹è¯•
./run-serverless-tests.sh all
```

### æ‰‹åŠ¨éƒ¨ç½²æ­¥éª¤

#### 1. ä½¿ç”¨è‡ªåŠ¨åŒ–è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
# èµ‹äºˆæ‰§è¡Œæƒé™
chmod +x run-serverless-tests.sh

# æ‰§è¡ŒPodå¯åŠ¨æ€§èƒ½æµ‹è¯•
./run-serverless-tests.sh startup

# æ‰§è¡Œå¼¹æ€§æ‰©ç¼©å®¹æ€§èƒ½æµ‹è¯•
./run-serverless-tests.sh scaling

# æ‰§è¡Œæ‰€æœ‰æ€§èƒ½æµ‹è¯•
./run-serverless-tests.sh all

# æŸ¥çœ‹æµ‹è¯•çŠ¶æ€
./run-serverless-tests.sh --status

# æ¸…ç†æµ‹è¯•èµ„æº
./run-serverless-tests.sh --cleanup
```

#### 2. æ‰‹åŠ¨æ‰§è¡Œæµ‹è¯•

**Podå¯åŠ¨æ€§èƒ½æµ‹è¯•**ï¼š
```bash
# éƒ¨ç½²å¿…è¦çš„æ¨¡æ¿å’ŒRBAC
kubectl create -f playbook/rbac.yaml && kubectl create -f playbook/all-in-one-template.yaml

# æ‰§è¡ŒPodå¯åŠ¨æ€§èƒ½æµ‹è¯•
kubectl create -f playbook/workflow/serverless-pod-startup-performance.yaml

# ç›‘æ§æµ‹è¯•è¿›åº¦
kubectl get workflow -n tke-chaos-test
kubectl describe workflow serverless-pod-startup-performance -n tke-chaos-test
```

**å¼¹æ€§æ‰©ç¼©å®¹æ€§èƒ½æµ‹è¯•**ï¼š
```bash
# æ‰§è¡Œæ‰©ç¼©å®¹æ€§èƒ½æµ‹è¯•
kubectl create -f playbook/workflow/serverless-scaling-performance.yaml

# ç›‘æ§HPAå’ŒPodçŠ¶æ€
kubectl get hpa -n tke-serverless-scaling-test -w
kubectl get pods -n tke-serverless-scaling-test -w
```

### æµ‹è¯•åœºæ™¯è¯´æ˜

| æµ‹è¯•åœºæ™¯ | æµ‹è¯•æ–‡ä»¶ | æµ‹è¯•å†…å®¹ | å…³é”®æŒ‡æ ‡ |
|---------|---------|---------|---------|
| Podå¯åŠ¨æ€§èƒ½ | `serverless-pod-startup-performance.yaml` | ä¸åŒè§„æ ¼Podå¯åŠ¨é€Ÿåº¦æµ‹è¯• | å¯åŠ¨æ—¶é—´ã€æˆåŠŸç‡ã€å¹¶å‘èƒ½åŠ› |
| å¼¹æ€§æ‰©ç¼©å®¹ | `serverless-scaling-performance.yaml` | HPAè‡ªåŠ¨æ‰©ç¼©å®¹å“åº”æµ‹è¯• | æ‰©ç¼©å®¹å“åº”æ—¶é—´ã€ç¨³å®šæ€§ |

### æ€§èƒ½æµ‹è¯•å‚æ•°é…ç½®

**Podå¯åŠ¨æ€§èƒ½æµ‹è¯•å‚æ•°**ï¼š
```yaml
pod-count-small: "10"      # å°è§„æ ¼Podæ•°é‡ (0.25C/0.5Gi)
pod-count-medium: "5"      # ä¸­è§„æ ¼Podæ•°é‡ (1C/2Gi)
pod-count-large: "3"       # å¤§è§„æ ¼Podæ•°é‡ (2C/4Gi)
startup-timeout: "120s"    # Podå¯åŠ¨è¶…æ—¶æ—¶é—´
test-duration: "300s"      # æµ‹è¯•æŒç»­æ—¶é—´
```

**å¼¹æ€§æ‰©ç¼©å®¹æµ‹è¯•å‚æ•°**ï¼š
```yaml
initial-replicas: "2"      # åˆå§‹å‰¯æœ¬æ•°
max-replicas: "20"         # æœ€å¤§å‰¯æœ¬æ•°
target-cpu-percent: "50"   # CPUç›®æ ‡ä½¿ç”¨ç‡
load-duration: "300s"      # è´Ÿè½½æŒç»­æ—¶é—´
cooldown-duration: "180s"  # å†·å´æ—¶é—´
```

### æŸ¥çœ‹æµ‹è¯•ç»“æœ

1. **é€šè¿‡Argo UIæŸ¥çœ‹**ï¼ˆæ¨èï¼‰ï¼š
   - è®¿é—® `LoadBalancer IP:2746`
   - ä½¿ç”¨tokenç™»å½•æŸ¥çœ‹è¯¦ç»†çš„æµ‹è¯•æµç¨‹å’Œç»“æœ

2. **é€šè¿‡å‘½ä»¤è¡ŒæŸ¥çœ‹**ï¼š
   ```bash
   # æŸ¥çœ‹å·¥ä½œæµçŠ¶æ€
   kubectl get workflow -n tke-chaos-test
   
   # æŸ¥çœ‹è¯¦ç»†ç»“æœ
   kubectl describe workflow <workflow-name> -n tke-chaos-test
   ```

3. **æŸ¥çœ‹è¯¦ç»†æµ‹è¯•æŒ‡å—**ï¼š
   ```bash
   cat playbook/TKE_SERVERLESS_PERFORMANCE_GUIDE.md
   ```

### æ€§èƒ½åŸºå‡†å‚è€ƒ

**Podå¯åŠ¨æ€§èƒ½**ï¼š
- å°è§„æ ¼Pod (0.25C/0.5Gi)ï¼šé€šå¸¸ < 10ç§’
- ä¸­è§„æ ¼Pod (1C/2Gi)ï¼šé€šå¸¸ < 15ç§’
- å¤§è§„æ ¼Pod (2C/4Gi)ï¼šé€šå¸¸ < 30ç§’
- å¯åŠ¨æˆåŠŸç‡ï¼šåº” > 95%

**æ‰©ç¼©å®¹æ€§èƒ½**ï¼š
- æ‰©å®¹å“åº”æ—¶é—´ï¼šé€šå¸¸ < 60ç§’
- ç¼©å®¹å“åº”æ—¶é—´ï¼šé€šå¸¸ < 120ç§’
- æ‰©ç¼©å®¹ç¨³å®šæ€§ï¼šæ— é¢‘ç¹æŠ–åŠ¨

## ğŸ—“ï¸ åŠŸèƒ½è§„åˆ’è·¯çº¿å›¾

| æµ‹è¯•åŠŸèƒ½                         | ä¼˜å…ˆçº§  | å½“å‰çŠ¶æ€     | è®¡åˆ’å‘å¸ƒæ—¶é—´  | æè¿°                                                |
|------------------------------|--------|------------|---------------|---------------------------------------------------|
| Podå¯åŠ¨æ€§èƒ½æµ‹è¯•                   | P0    |    âœ… å®Œæˆ    |      -       | å¤šè§„æ ¼Podå¯åŠ¨é€Ÿåº¦ã€æˆåŠŸç‡ã€å¹¶å‘æ€§èƒ½æµ‹è¯•                        |
| å¼¹æ€§æ‰©ç¼©å®¹æ€§èƒ½æµ‹è¯•                 | P0    |    âœ… å®Œæˆ    |      -       | HPAè‡ªåŠ¨æ‰©ç¼©å®¹å“åº”æ—¶é—´ã€ç¨³å®šæ€§æµ‹è¯•                          |
| ç½‘ç»œæ€§èƒ½æµ‹è¯•                      | P1    |    ğŸš§ å¼€å‘ä¸­  |  2025-02-28  | Podé—´é€šä¿¡å»¶è¿Ÿã€Serviceè´Ÿè½½å‡è¡¡ã€Ingressååé‡æµ‹è¯•           |
| å­˜å‚¨æ€§èƒ½æµ‹è¯•                      | P1    |    ğŸ“‹ è§„åˆ’ä¸­  |  2025-03-31  | PVCæŒ‚è½½æ€§èƒ½ã€ä¸åŒå­˜å‚¨ç±»å‹I/Oæ€§èƒ½æµ‹è¯•                       |
| å†·å¯åŠ¨vsçƒ­å¯åŠ¨å¯¹æ¯”æµ‹è¯•             | P1    |    ğŸ“‹ è§„åˆ’ä¸­  |  2025-02-15  | é•œåƒç¼“å­˜å¯¹å¯åŠ¨æ€§èƒ½çš„å½±å“åˆ†æ                              |
| æˆæœ¬æ•ˆç›Šåˆ†ææµ‹è¯•                  | P2    |    ğŸ“‹ è§„åˆ’ä¸­  |  2025-04-30  | ä¸åŒè§„æ ¼Podçš„æˆæœ¬æ•ˆç›Šæ¯”åˆ†æ                             |
| æ‰¹é‡ä»»åŠ¡æ€§èƒ½æµ‹è¯•                  | P2    |    ğŸ“‹ è§„åˆ’ä¸­  |  2025-05-31  | Job/CronJobåœ¨Serverlessç¯å¢ƒä¸‹çš„æ€§èƒ½è¡¨ç°               |
| å¤šç§Ÿæˆ·éš”ç¦»æ€§èƒ½æµ‹è¯•                | P2    |    ğŸ“‹ è§„åˆ’ä¸­  |  2025-06-30  | å¤šç§Ÿæˆ·åœºæ™¯ä¸‹çš„èµ„æºéš”ç¦»å’Œæ€§èƒ½å½±å“                           |
| GPUå·¥ä½œè´Ÿè½½æ€§èƒ½æµ‹è¯•               | P3    |    ğŸ“‹ è§„åˆ’ä¸­  |  2025-07-31  | GPUåŠ é€Ÿå·¥ä½œè´Ÿè½½åœ¨Serverlessç¯å¢ƒä¸‹çš„æ€§èƒ½                 |
| ç›‘æ§å’Œå‘Šè­¦é›†æˆ                    | P1    |    ğŸ“‹ è§„åˆ’ä¸­  |  2025-03-15  | é›†æˆPrometheusã€Grafanaç›‘æ§å’Œå‘Šè­¦                    |

## â“ å¸¸è§é—®é¢˜

### 1. ä¸ºä»€ä¹ˆéœ€è¦ä¸¤ä¸ªé›†ç¾¤è¿›è¡Œæ€§èƒ½æµ‹è¯•ï¼Ÿ

**ç­”**ï¼šæ€§èƒ½æµ‹è¯•åŸºäº`Argo Workflow`è¿›è¡Œç¼–æ’ï¼Œ`Argo Workflow`å¼ºä¾èµ–`kube-apiserver`ã€‚ä¸ºäº†ç¡®ä¿æµ‹è¯•è¿‡ç¨‹çš„ç¨³å®šæ€§å’Œå‡†ç¡®æ€§ï¼š
- **æºé›†ç¾¤**ï¼šè¿è¡ŒArgo Workflowï¼Œè´Ÿè´£æµ‹è¯•ç¼–æ’å’Œç»“æœæ”¶é›†
- **ç›®æ ‡é›†ç¾¤**ï¼šTKE Serverlessé›†ç¾¤ï¼Œä½œä¸ºè¢«æµ‹è¯•å¯¹è±¡

è¿™æ ·å¯ä»¥é¿å…æµ‹è¯•è¿‡ç¨‹ä¸­å¯¹æ§åˆ¶å¹³é¢çš„å½±å“ï¼Œç¡®ä¿æµ‹è¯•ç»“æœçš„å¯é æ€§ã€‚

### 2. å¦‚ä½•ç›‘æ§æ€§èƒ½æµ‹è¯•çš„æ‰§è¡Œè¿›åº¦ï¼Ÿ

**ç­”**ï¼šæ‚¨å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼ç›‘æ§æµ‹è¯•è¿›åº¦ï¼š

```bash
# æ–¹æ³•1ï¼šæŸ¥çœ‹å·¥ä½œæµçŠ¶æ€
kubectl get workflow -n tke-serverless-test

# æ–¹æ³•2ï¼šæŸ¥çœ‹è¯¦ç»†æ‰§è¡Œä¿¡æ¯
kubectl describe workflow <workflow-name> -n tke-serverless-test

# æ–¹æ³•3ï¼šå®æ—¶ç›‘æ§PodçŠ¶æ€
kubectl get pods -n tke-serverless-test -w

# æ–¹æ³•4ï¼šä½¿ç”¨è‡ªåŠ¨åŒ–è„šæœ¬
./run-serverless-tests.sh --status

# æ–¹æ³•5ï¼šè®¿é—®Argo UIï¼ˆæ¨èï¼‰
# æµè§ˆå™¨è®¿é—® LoadBalancer IP:2746
```

### 3. æ€§èƒ½æµ‹è¯•å¤±è´¥çš„å¸¸è§åŸå› æœ‰å“ªäº›ï¼Ÿ

**ç­”**ï¼šå¸¸è§çš„å¤±è´¥åŸå› åŒ…æ‹¬ï¼š

**ç¯å¢ƒé…ç½®é—®é¢˜**ï¼š
- TKE Serverlessé›†ç¾¤é…ç½®ä¸æ­£ç¡®
- kubeconfigå‡­è¯è¿‡æœŸæˆ–æƒé™ä¸è¶³
- ç½‘ç»œè¿æ¥é—®é¢˜

**èµ„æºé—®é¢˜**ï¼š
- é›†ç¾¤èµ„æºé…é¢ä¸è¶³
- ServerlessèŠ‚ç‚¹æ± æœªæ­£ç¡®é…ç½®
- é•œåƒæ‹‰å–å¤±è´¥

**æƒé™é—®é¢˜**ï¼š
- RBACæƒé™é…ç½®ä¸å½“
- ServiceAccountæƒé™ä¸è¶³

**æ’æŸ¥æ–¹æ³•**ï¼š
```bash
# æ£€æŸ¥Podæ—¥å¿—
kubectl logs <pod-name> -n tke-serverless-test

# æ£€æŸ¥äº‹ä»¶
kubectl get events -n tke-serverless-test --sort-by='.lastTimestamp'

# æ£€æŸ¥å·¥ä½œæµè¯¦æƒ…
kubectl describe workflow <workflow-name> -n tke-serverless-test
```

### 4. å¦‚ä½•è§£è¯»æ€§èƒ½æµ‹è¯•ç»“æœï¼Ÿ

**ç­”**ï¼šæ€§èƒ½æµ‹è¯•ç»“æœåŒ…å«å¤šä¸ªå…³é”®æŒ‡æ ‡ï¼š

**Podå¯åŠ¨æ€§èƒ½**ï¼š
- **å¯åŠ¨æ—¶é—´**ï¼šä»Podåˆ›å»ºåˆ°RunningçŠ¶æ€çš„æ—¶é—´
- **æˆåŠŸç‡**ï¼šæˆåŠŸå¯åŠ¨çš„Podå æ€»æ•°çš„æ¯”ä¾‹
- **å¹¶å‘èƒ½åŠ›**ï¼šåŒæ—¶å¯åŠ¨å¤šä¸ªPodçš„æ€§èƒ½è¡¨ç°

**æ‰©ç¼©å®¹æ€§èƒ½**ï¼š
- **æ‰©å®¹å“åº”æ—¶é—´**ï¼šä»è´Ÿè½½å¢åŠ åˆ°æ–°Podå°±ç»ªçš„æ—¶é—´
- **ç¼©å®¹å“åº”æ—¶é—´**ï¼šä»è´Ÿè½½é™ä½åˆ°Podç»ˆæ­¢çš„æ—¶é—´
- **ç¨³å®šæ€§**ï¼šæ‰©ç¼©å®¹è¿‡ç¨‹ä¸­æ˜¯å¦å‡ºç°æŠ–åŠ¨

**åŸºå‡†å¯¹æ¯”**ï¼š
```
ä¼˜ç§€ï¼šPodå¯åŠ¨ < 10sï¼Œæ‰©å®¹å“åº” < 30s
è‰¯å¥½ï¼šPodå¯åŠ¨ < 20sï¼Œæ‰©å®¹å“åº” < 60s
éœ€ä¼˜åŒ–ï¼šPodå¯åŠ¨ > 30sï¼Œæ‰©å®¹å“åº” > 90s
```

### 5. å¦‚ä½•ä¼˜åŒ–TKE Serverlessçš„æ€§èƒ½ï¼Ÿ

**ç­”**ï¼šåŸºäºæµ‹è¯•ç»“æœï¼Œæ‚¨å¯ä»¥ä»ä»¥ä¸‹æ–¹é¢ä¼˜åŒ–ï¼š

**é•œåƒä¼˜åŒ–**ï¼š
- ä½¿ç”¨è½»é‡çº§åŸºç¡€é•œåƒï¼ˆå¦‚alpineï¼‰
- å‡å°‘é•œåƒå±‚æ•°å’Œå¤§å°
- å¯ç”¨é•œåƒç¼“å­˜åŠŸèƒ½

**èµ„æºé…ç½®ä¼˜åŒ–**ï¼š
- æ ¹æ®å®é™…éœ€æ±‚è®¾ç½®åˆé€‚çš„CPU/å†…å­˜è§„æ ¼
- é¿å…è¿‡åº¦é…ç½®èµ„æº
- ä½¿ç”¨èµ„æºé¢„ç•™åŠŸèƒ½

**æ‰©ç¼©å®¹ç­–ç•¥ä¼˜åŒ–**ï¼š
- è°ƒæ•´HPAçš„CPU/å†…å­˜é˜ˆå€¼
- é…ç½®åˆé€‚çš„æ‰©ç¼©å®¹ç­–ç•¥å’Œå†·å´æ—¶é—´
- è€ƒè™‘ä½¿ç”¨VPAè¿›è¡Œå‚ç›´æ‰©ç¼©å®¹

### 6. æµ‹è¯•ç¯å¢ƒçš„æœ€ä½³å®è·µæ˜¯ä»€ä¹ˆï¼Ÿ

**ç­”**ï¼šå»ºè®®éµå¾ªä»¥ä¸‹æœ€ä½³å®è·µï¼š

**ç¯å¢ƒéš”ç¦»**ï¼š
- ä½¿ç”¨ä¸“é—¨çš„æµ‹è¯•ç¯å¢ƒï¼Œé¿å…å½±å“ç”Ÿäº§
- ä¸ºä¸åŒç±»å‹çš„æµ‹è¯•åˆ›å»ºç‹¬ç«‹çš„å‘½åç©ºé—´

**å®šæœŸæµ‹è¯•**ï¼š
- å»ºç«‹å®šæœŸçš„æ€§èƒ½åŸºå‡†æµ‹è¯•
- åœ¨é‡å¤§å˜æ›´å‰åè¿›è¡Œå¯¹æ¯”æµ‹è¯•

**ç›‘æ§å‘Šè­¦**ï¼š
- é…ç½®æ€§èƒ½ç›‘æ§å’Œå‘Šè­¦
- å»ºç«‹æ€§èƒ½è¶‹åŠ¿åˆ†æ

**æˆæœ¬æ§åˆ¶**ï¼š
- åŠæ—¶æ¸…ç†æµ‹è¯•èµ„æº
- ç›‘æ§æµ‹è¯•æˆæœ¬

### 7. å¦‚ä½•é›†æˆåˆ°CI/CDæµæ°´çº¿ï¼Ÿ

**ç­”**ï¼šæ‚¨å¯ä»¥å°†æ€§èƒ½æµ‹è¯•é›†æˆåˆ°CI/CDæµæ°´çº¿ä¸­ï¼š

```yaml
# GitHub Actionsç¤ºä¾‹
name: TKE Serverless Performance Test
on:
  schedule:
    - cron: '0 2 * * *'  # æ¯æ—¥å‡Œæ™¨2ç‚¹æ‰§è¡Œ
  workflow_dispatch:     # æ‰‹åŠ¨è§¦å‘

jobs:
  performance-test:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - name: Setup kubectl
      uses: azure/setup-kubectl@v3
    - name: Run Performance Tests
      run: |
        chmod +x run-serverless-tests.sh
        ./run-serverless-tests.sh all
    - name: Upload Results
      uses: actions/upload-artifact@v3
      with:
        name: performance-results
        path: test-results/
```

### 8. å¦‚ä½•è·å¾—æŠ€æœ¯æ”¯æŒï¼Ÿ

**ç­”**ï¼šå¦‚æœé‡åˆ°é—®é¢˜ï¼Œæ‚¨å¯ä»¥ï¼š

- ğŸ“– æŸ¥çœ‹è¯¦ç»†æ–‡æ¡£ï¼š`playbook/TKE_SERVERLESS_PERFORMANCE_GUIDE.md`
- ğŸ› æäº¤Issueï¼š[GitHub Issues](https://github.com/wi1123/EKS-playbook/issues)
- ğŸ’¬ å‚ä¸è®¨è®ºï¼š[GitHub Discussions](https://github.com/wi1123/EKS-playbook/discussions)
- ğŸ“§ è”ç³»ç»´æŠ¤è€…ï¼šé€šè¿‡GitHubè”ç³»é¡¹ç›®ç»´æŠ¤è€…

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [TKE Serverlessæ€§èƒ½æµ‹è¯•è¯¦ç»†æŒ‡å—](playbook/TKE_SERVERLESS_PERFORMANCE_GUIDE.md)
- [è´¡çŒ®æŒ‡å—](CONTRIBUTING.md)
- [Argo Workflowå®˜æ–¹æ–‡æ¡£](https://argoproj.github.io/argo-workflows/)
- [è…¾è®¯äº‘TKE Serverlessæ–‡æ¡£](https://cloud.tencent.com/document/product/457)

## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®ä»£ç ã€æ–‡æ¡£æˆ–æå‡ºå»ºè®®ï¼è¯·æŸ¥çœ‹[è´¡çŒ®æŒ‡å—](CONTRIBUTING.md)äº†è§£è¯¦ç»†ä¿¡æ¯ã€‚

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨Apache License 2.0è®¸å¯è¯ - è¯¦è§[LICENSE](LICENSE)æ–‡ä»¶ã€‚

---

**ä¸ºKuberneteså’ŒServerlessç¤¾åŒºè€Œç”Ÿ â¤ï¸**
